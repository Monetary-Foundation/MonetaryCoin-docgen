---
id: distribution_MCoinDistribution
title: MCoinDistribution
---

<div class="contract-doc"><div class="contract"><h2 class="contract-header"><span class="contract-kind">contract</span> MCoinDistribution</h2><p class="base-contracts"><span>is</span> <a href="ownership_Ownable.html">Ownable</a></p><p class="description">MCoinDistribution Used to distribute a fixed amount of token per window. Users can commit Ether to a certain window. After a window closes, a user can withdraw the reward using withdraw(uint256 window) function or use withdrawAll() function to get tokens from all windows in a single transaction. The amount of tokens allocated to a user for a given window equals (window allocation) * (user eth) / (total eth) User can get the details of the current window using detailsOfWindow() function. The first-period allocation is larger than second-period allocation (per window).</p><div class="source">Source: <a href="https://github.com/Monetary-Foundation/MonetaryCoin/blob/v1.0.0/contracts/distribution/MCoinDistribution.sol" target="_blank">distribution/MCoinDistribution.sol</a></div></div><div class="index"><h2>Index</h2><ul><li><a href="distribution_MCoinDistribution.html#Commit">Commit</a></li><li><a href="distribution_MCoinDistribution.html#MoveFunds">MoveFunds</a></li><li><a href="distribution_MCoinDistribution.html#Withdraw">Withdraw</a></li><li><a href="distribution_MCoinDistribution.html#allocationFor">allocationFor</a></li><li><a href="distribution_MCoinDistribution.html#commit">commit</a></li><li><a href="distribution_MCoinDistribution.html#commitOn">commitOn</a></li><li><a href="distribution_MCoinDistribution.html#currentWindow">currentWindow</a></li><li><a href="distribution_MCoinDistribution.html#detailsOf">detailsOf</a></li><li><a href="distribution_MCoinDistribution.html#detailsOfWindow">detailsOfWindow</a></li><li><a href="distribution_MCoinDistribution.html#">fallback</a></li><li><a href="distribution_MCoinDistribution.html#">cosntructor</a></li><li><a href="distribution_MCoinDistribution.html#getAllRewards">getAllRewards</a></li><li><a href="distribution_MCoinDistribution.html#getCommitmentsOf">getCommitmentsOf</a></li><li><a href="distribution_MCoinDistribution.html#getTotals">getTotals</a></li><li><a href="distribution_MCoinDistribution.html#init">init</a></li><li><a href="distribution_MCoinDistribution.html#moveFunds">moveFunds</a></li><li><a href="distribution_MCoinDistribution.html#windowOf">windowOf</a></li><li><a href="distribution_MCoinDistribution.html#withdraw">withdraw</a></li><li><a href="distribution_MCoinDistribution.html#withdrawAll">withdrawAll</a></li></ul></div><div class="reference"><h2>Reference</h2><div class="events"><h3>Events</h3><ul><li><div class="item event"><span id="Commit" class="anchor-marker"></span><h4 class="name">Commit</h4><div class="body"><code class="signature">event <strong>Commit</strong><span>(address from, uint256 value, uint256 window) </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>from</code> - address</div><div><code>value</code> - uint256</div><div><code>window</code> - uint256</div></dd></dl></div></div></li><li><div class="item event"><span id="MoveFunds" class="anchor-marker"></span><h4 class="name">MoveFunds</h4><div class="body"><code class="signature">event <strong>MoveFunds</strong><span>(uint256 value) </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>value</code> - uint256</div></dd></dl></div></div></li><li><div class="item event"><span id="Withdraw" class="anchor-marker"></span><h4 class="name">Withdraw</h4><div class="body"><code class="signature">event <strong>Withdraw</strong><span>(address from, uint256 value, uint256 window) </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>from</code> - address</div><div><code>value</code> - uint256</div><div><code>window</code> - uint256</div></dd></dl></div></div></li></ul></div><div class="functions"><h3>Functions</h3><ul><li><div class="item function"><span id="allocationFor" class="anchor-marker"></span><h4 class="name">allocationFor</h4><div class="body"><code class="signature">function <strong>allocationFor</strong><span>(uint256 window) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Return allocation for given window.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>window</code> - the desired window</div></dd><dt><span class="label-return">Returns:</span></dt><dd>the number of tokens to distribute in the given window</dd></dl></div></div></li><li><div class="item function"><span id="commit" class="anchor-marker"></span><h4 class="name">commit</h4><div class="body"><code class="signature">function <strong>commit</strong><span>() </span><span>public </span><span>payable </span></code><hr/><div class="description"><p>Commit funds for the current window.</p></div></div></div></li><li><div class="item function"><span id="commitOn" class="anchor-marker"></span><h4 class="name">commitOn</h4><div class="body"><code class="signature">function <strong>commitOn</strong><span>(uint256 window) </span><span>public </span><span>payable </span></code><hr/><div class="description"><p>Commit funds for a given window Tokens for commited window need to be withdrawn after window closes using withdraw(uint256 window) function first window: 0 last window: totalWindows - 1.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>window</code> - to commit [0-totalWindows)</div></dd></dl></div></div></li><li><div class="item function"><span id="currentWindow" class="anchor-marker"></span><h4 class="name">currentWindow</h4><div class="body"><code class="signature">function <strong>currentWindow</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Return the number of the current window.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>the window, range: [0-totalWindows)</dd></dl></div></div></li><li><div class="item function"><span id="detailsOf" class="anchor-marker"></span><h4 class="name">detailsOf</h4><div class="body"><code class="signature">function <strong>detailsOf</strong><span>(uint256 window) </span><span>public </span><span>view </span><span>returns  (uint256, uint256, uint256, uint256, uint256, uint256) </span></code><hr/><div class="description"><p>Return information about the selected window.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>window</code> - number: [0-totalWindows)</div></dd><dt><span class="label-return">Returns:</span></dt><dd>{ &quot;uint256 start&quot;: window start timestamp &quot;uint256 end&quot;: window end timestamp &quot;uint256 remainingTime&quot;: remaining time (sec), zero if ended &quot;uint256 allocation&quot;: number of tokens to be distributed &quot;uint256 totalEth&quot;: total eth commited this window &quot;uint256 number&quot;: # of requested window }</dd></dl></div></div></li><li><div class="item function"><span id="detailsOfWindow" class="anchor-marker"></span><h4 class="name">detailsOfWindow</h4><div class="body"><code class="signature">function <strong>detailsOfWindow</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256, uint256, uint256, uint256, uint256, uint256) </span></code><hr/><div class="description"><p>Return information for the current window.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>{ &quot;uint256 start&quot;: window start timestamp &quot;uint256 end&quot;: window end timestamp &quot;uint256 remainingTime&quot;: remaining time (sec), zero if ended &quot;uint256 allocation&quot;: number of tokens to be distributed &quot;uint256 totalEth&quot;: total eth commited this window &quot;uint256 number&quot;: # of requested window }</dd></dl></div></div></li><li><div class="item function"><span id="fallback" class="anchor-marker"></span><h4 class="name">fallback</h4><div class="body"><code class="signature">function <strong></strong><span>() </span><span>public </span><span>payable </span></code><hr/><div class="description"><p>Commit used as a fallback.</p></div></div></div></li><li><div class="item function"><span id="cosntructor" class="anchor-marker"></span><h4 class="name">cosntructor</h4><div class="body"><code class="signature">function <strong></strong><span>(uint256 _firstPeriodWindows, uint256 _firstPeriodSupply, uint256 _secondPeriodWindows, uint256 _secondPeriodSupply, address _foundationWallet, uint256 _foundationReserve, uint256 _startTimestamp, uint256 _windowLength) </span><span>public </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_firstPeriodWindows</code> - uint256</div><div><code>_firstPeriodSupply</code> - uint256</div><div><code>_secondPeriodWindows</code> - uint256</div><div><code>_secondPeriodSupply</code> - uint256</div><div><code>_foundationWallet</code> - address</div><div><code>_foundationReserve</code> - uint256</div><div><code>_startTimestamp</code> - uint256</div><div><code>_windowLength</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="getAllRewards" class="anchor-marker"></span><h4 class="name">getAllRewards</h4><div class="body"><code class="signature">function <strong>getAllRewards</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256[]) </span></code><hr/><div class="description"><p>Returns a array which contains reward for every closed window a convinience function to be called for updating a GUI. To get the reward tokens use withdrawAll(), which consumes less gas.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256[] rewards - the calculated number of tokens for every closed window</dd></dl></div></div></li><li><div class="item function"><span id="getCommitmentsOf" class="anchor-marker"></span><h4 class="name">getCommitmentsOf</h4><div class="body"><code class="signature">function <strong>getCommitmentsOf</strong><span>(address from) </span><span>public </span><span>view </span><span>returns  (uint256[]) </span></code><hr/><div class="description"><p>Returns a array filled with commitments of address for every window a convinience function to be called for updating a GUI.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>from</code> - address</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256[] commitments - the commited Eth per window of a given address</dd></dl></div></div></li><li><div class="item function"><span id="getTotals" class="anchor-marker"></span><h4 class="name">getTotals</h4><div class="body"><code class="signature">function <strong>getTotals</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256[]) </span></code><hr/><div class="description"><p>Returns a array filled with eth totals for every window a convinience function to be called for updating a GUI.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256[] ethTotals - the totals for commited Eth per window</dd></dl></div></div></li><li><div class="item function"><span id="init" class="anchor-marker"></span><h4 class="name">init</h4><div class="body"><code class="signature">function <strong>init</strong><span>(MineableToken _MCoin) </span><span>public </span></code><hr/><div class="description"><p>Initiate the distribution.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="ownership_Ownable.html#onlyOwner">onlyOwner </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_MCoin</code> - the token to distribute</div></dd></dl></div></div></li><li><div class="item function"><span id="moveFunds" class="anchor-marker"></span><h4 class="name">moveFunds</h4><div class="body"><code class="signature">function <strong>moveFunds</strong><span>() </span><span>public </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Moves Eth to the foundation wallet.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="ownership_Ownable.html#onlyOwner">onlyOwner </a></dd><dt><span class="label-return">Returns:</span></dt><dd>the amount to be moved.</dd></dl></div></div></li><li><div class="item function"><span id="windowOf" class="anchor-marker"></span><h4 class="name">windowOf</h4><div class="body"><code class="signature">function <strong>windowOf</strong><span>(uint256 timestamp) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Return the window number for given timestamp.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>timestamp</code> - uint256</div></dd><dt><span class="label-return">Returns:</span></dt><dd>number of the current window in [0,inf) zero will be returned before distribution start and during the first window.</dd></dl></div></div></li><li><div class="item function"><span id="withdraw" class="anchor-marker"></span><h4 class="name">withdraw</h4><div class="body"><code class="signature">function <strong>withdraw</strong><span>(uint256 window) </span><span>public </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Withdraw tokens after the window has closed.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>window</code> - to withdraw</div></dd><dt><span class="label-return">Returns:</span></dt><dd>the calculated number of tokens</dd></dl></div></div></li><li><div class="item function"><span id="withdrawAll" class="anchor-marker"></span><h4 class="name">withdrawAll</h4><div class="body"><code class="signature">function <strong>withdrawAll</strong><span>() </span><span>public </span></code><hr/><div class="description"><p>Get the reward from all closed windows.</p></div></div></div></li></ul></div></div></div>
